function initCarousel(g){let v=document.getElementById(g);if(v){let m=v.closest(".carousel-container");if(m){let o=v.querySelectorAll(".carousel-slide"),c=m.querySelector(".carousel-dots"),u=m.querySelector(".carousel-control.prev"),d=m.querySelector(".carousel-control.next");if(0===o.length)console.warn("Aucun slide trouvé dans le carrousel.");else{let s=0,a=o.length,e=null,t=0,r,n=!1,i=!1,l=null;if(c){c.innerHTML="";for(let t=0;t<a;t++){var p=document.createElement("button");p.className="carousel-dot"+(0===t?" active":""),p.setAttribute("type","button"),p.setAttribute("data-index",t),p.setAttribute("aria-label",`Aller au slide ${t+1} sur `+a),p.setAttribute("aria-controls",g),p.setAttribute("tabindex","0"),p.addEventListener("click",()=>h(t)),p.addEventListener("keydown",e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),h(t))}),c.appendChild(p)}}y(),u&&u.addEventListener("click",()=>f(-1)),d&&d.addEventListener("click",()=>f(1)),v.addEventListener("keydown",e=>{"ArrowLeft"===e.key?(e.preventDefault(),f(-1),S()):"ArrowRight"===e.key?(e.preventDefault(),f(1),S()):"Home"===e.key?(e.preventDefault(),h(0),S()):"End"===e.key&&(e.preventDefault(),h(a-1),S())}),v.addEventListener("touchstart",e=>{t=e.changedTouches[0].screenX,L()},{passive:!0}),v.addEventListener("touchend",e=>{(r=e.changedTouches[0].screenX)<t-50?f(1):r>t+50&&f(-1),S()},{passive:!0}),v.addEventListener("mouseenter",()=>{n=!0,w()}),v.addEventListener("mouseleave",()=>{n=!1,i&&S()}),document.addEventListener("visibilitychange",()=>{document.hidden?n=!0:i&&(n=!1,S())}),"home-carousel"===g&&"disabled"!==sessionStorage.getItem("carouselAutoplay")&&b();return["mousedown","mousemove","keydown","scroll","touchstart","click"].forEach(e=>{document.addEventListener(e,S,{passive:!0})}),S(),{next:()=>f(1),prev:()=>f(-1),goTo:h,startAutoPlay:b,stopAutoPlay:L,togglePlayPause:function(){((n=!n)?L:b)(),w()}};function y(){o.forEach((e,t)=>{t=t===s;e.classList.toggle("active",t),e.setAttribute("aria-hidden",!t),t?(e.removeAttribute("inert"),e.setAttribute("tabindex","0")):(e.setAttribute("inert",""),e.setAttribute("tabindex","-1"))}),c&&c.querySelectorAll(".carousel-dot").forEach((e,t)=>{t=t===s;e.classList.toggle("active",t),e.setAttribute("aria-current",t),e.setAttribute("tabindex",t?"0":"-1")}),u&&(u.setAttribute("aria-label","Précédent"),u.setAttribute("aria-controls",g)),d&&(d.setAttribute("aria-label","Suivant"),d.setAttribute("aria-controls",g));var e=o[s].querySelector("h2, .card-title")?.textContent||"Slide "+(s+1);let t=v.querySelector(".sr-announce");t||((t=document.createElement("div")).className="sr-announce",t.setAttribute("aria-live","polite"),t.setAttribute("aria-atomic","true"),t.style.position="absolute",t.style.overflow="hidden",t.style.clip="rect(0 0 0 0)",t.style.height="1px",t.style.width="1px",t.style.margin="-1px",t.style.padding="0",t.style.border="0",v.appendChild(t)),t.textContent=`Diapositive ${s+1} sur ${a}: `+e}function f(e){s=(s+e+a)%a,y(),S()}function h(e){e<0||e>=a||(s=e,y(),S())}function b(){i||"disabled"===sessionStorage.getItem("carouselAutoplay")||window.matchMedia("(prefers-reduced-motion: reduce)").matches||(n=!1,i=!0,L(),e=setInterval(()=>{n||f(1)},5e3),w())}function L(){e&&(clearInterval(e),e=null),i=!1}function w(){var e=m.querySelector(".carousel-play");e&&(n||!i?(e.innerHTML='<i class="fas fa-play"></i>',e.setAttribute("aria-label","Lire le diaporama")):(e.innerHTML='<i class="fas fa-pause"></i>',e.setAttribute("aria-label","Mettre en pause")))}function S(){l&&clearTimeout(l),l=setTimeout(()=>{L()},6e5)}function S(){l&&clearTimeout(l),i&&!n&&(l=setTimeout(()=>{L(),sessionStorage.setItem("carouselAutoplay","disabled"),w()},6e5))}function S(){clearTimeout(l),"disabled"!==sessionStorage.getItem("carouselAutoplay")&&(l=setTimeout(()=>{L(),sessionStorage.setItem("carouselAutoplay","disabled"),playPauseBtn&&(playPauseBtn.innerHTML='<i class="fas fa-play"></i>',playPauseBtn.setAttribute("title","Lire le diaporama"))},6e5))}}}else console.warn("Conteneur parent .carousel-container non trouvé.")}else console.warn(`Carrousel avec l'ID "${g}" non trouvé.`)}function showNoNewsMessage(e,t="Aucune actualité à afficher pour le moment."){e&&(e.innerHTML=`
        <div class="no-news" style="text-align: center; padding: 2rem;">
            <i class="fas fa-newspaper" style="font-size: 3rem; color: #ccc; margin-bottom: 1rem;"></i>
            <p>${t}</p>
        </div>`)}function initNewsCarousel(o){var c=document.getElementById("actualites-container");if(c){c.innerHTML="";o=`
        <div class="carousel-container">
            <div class="carousel-track">
                ${o.map((e,t)=>`
                    <div class="carousel-item" data-index="${t}">
                        <div class="actualite-item">
                            <img src="${e.image_url}" alt="${e.titre||"Actualité"}" class="actualite-image" onerror="this.src='assets/images/placeholder.jpg'">
                            <div class="actualite-content">
                                ${e.date?`<div class="actualite-date">${new Date(e.date).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})}</div>`:""}
                                <h3 class="actualite-title">${e.titre||"Sans titre"}</h3>
                                <p class="actualite-desc">${e.contenu?e.contenu.substring(0,150)+(150<e.contenu.length?"...":""):""}</p>
                                ${e.lien?`<a href="${e.lien}" class="actualite-link">Lire la suite</a>`:""}
                            </div>
                        </div>
                    </div>
                `).join("")}
            </div>
            ${1<o.length?`
                <button class="carousel-arrow prev" aria-label="Article précédent">❮</button>
                <button class="carousel-arrow next" aria-label="Article suivant">❯</button>
                <div class="carousel-nav">
                    ${o.map((e,t)=>`
                        <button class="carousel-dot ${0===t?"active":""}" data-index="${t}" aria-label="Aller à l'article ${t+1}"></button>
                    `).join("")}
                </div>
            `:""}
        </div>
    `;c.innerHTML=o;let e=c.querySelector(".carousel-track"),t=c.querySelectorAll(".carousel-item"),s=c.querySelectorAll(".carousel-dot"),a=c.querySelector(".carousel-arrow.prev"),r=c.querySelector(".carousel-arrow.next"),n=0,i=Math.min(3,t.length),l=100/i;if(a&&a.addEventListener("click",()=>{0<n&&(n--,u())}),r&&r.addEventListener("click",()=>{0<t.length&&n<t.length-i&&(n++,u())}),s&&0<s.length&&s.forEach(e=>{e.addEventListener("click",()=>{n=parseInt(e.dataset.index),u()})}),document.addEventListener("keydown",e=>{"ArrowLeft"===e.key&&0<n?(n--,u()):"ArrowRight"===e.key&&0<t.length&&n<t.length-i&&(n++,u())}),u(),1<t.length){let e=setInterval(()=>{n<t.length-i?n++:n=0,u()},5e3);c.addEventListener("mouseenter",()=>{clearInterval(e)}),c.addEventListener("mouseleave",()=>{e=setInterval(()=>{n<t.length-i?n++:n=0,u()},5e3)})}function u(){e&&(e.style.transform=`translateX(-${n*l}%`),s&&0<s.length&&s.forEach((e,t)=>{e.classList.toggle("active",t===n)}),a&&(a.style.display=0===n?"none":"flex"),r&&(r.style.display=n>=t.length-i?"none":"flex")}}}document.addEventListener("DOMContentLoaded",function(){let t=document.querySelector(".menu-toggle"),s=document.querySelector(".nav-links"),a=document.querySelector("header");if(t&&s&&(t.addEventListener("click",function(e){e.preventDefault(),s.classList.toggle("active"),this.classList.toggle("active"),document.body.classList.toggle("menu-open")}),document.addEventListener("click",e=>{t.contains(e.target)||s.contains(e.target)||(s.classList.remove("active"),t.classList.remove("active"),document.body.classList.remove("menu-open"))})),a){let t=0;window.addEventListener("scroll",()=>{var e=window.pageYOffset;e<=0?a.classList.remove("scroll-up"):(e>t&&!a.classList.contains("scroll-down")?(a.classList.remove("scroll-up"),a.classList.add("scroll-down")):e<t&&a.classList.contains("scroll-down")&&(a.classList.remove("scroll-down"),a.classList.add("scroll-up")),t=e)})}var e=()=>{document.querySelectorAll(".fade-in, .slide-up, .slide-left, .slide-right").forEach(e=>{e.getBoundingClientRect().top<window.innerHeight/1.3&&e.classList.add("visible")})},r=()=>{992<window.innerWidth?(s&&(s.style.display=""),document.body.classList.remove("menu-open")):s&&(s.classList.contains("active")?s.style.display="block":s.style.display="none")};window.addEventListener("scroll",e),window.addEventListener("resize",r),e(),r()}),document.addEventListener("DOMContentLoaded",function(){let t=window.matchMedia("(prefers-reduced-motion: reduce)").matches;document.querySelectorAll(".carousel-slider").forEach(e=>{e.id&&(e.setAttribute("role","region"),e.setAttribute("aria-roledescription","carousel"),e.setAttribute("aria-live","off"),initCarousel(e.id),t)&&(e=e.closest(".carousel-container"))&&(e=e.querySelector(".carousel-play"))&&(e.style.display="none")}),document.addEventListener("click",e=>{var t;e.target.closest(".carousel-play")&&(e=e.target.closest(".carousel-container"))&&(t=e.querySelector(".carousel-slider")?.id)&&document.getElementById(t)&&(e.querySelector(".carousel-play").innerHTML.includes("play")?sessionStorage.setItem("carouselAutoplay","enabled"):sessionStorage.setItem("carouselAutoplay","disabled"),initCarousel(t))})}),document.addEventListener("DOMContentLoaded",function(){console.log("Script contact.js chargé avec succès");let a=document.getElementById("contactForm");if(a){var e=document.getElementById("service");let s=document.getElementById("fichiers-candidature");e&&s&&e.addEventListener("change",function(){"candidature"===this.value?s.style.display="block":s.style.display="none"}),a.addEventListener("submit",function(t){t.preventDefault();t=new FormData(a),t=Object.fromEntries(t.entries());if(t.service&&t.name&&t.email&&t.message)if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.email)){console.log("Formulaire soumis avec succès :",t);let e="Votre message a été envoyé avec succès. ";"candidature"===t.service?e+="Nous examinerons votre candidature et vous recontacterons rapidement.":e+="Nous vous contacterons bientôt !",alert(e),a.reset(),s&&(s.style.display="none")}else alert("Veuillez entrer une adresse email valide.");else alert("Veuillez remplir tous les champs obligatoires marqués d'un *")})}else console.log("Formulaire de contact non trouvé")}),document.addEventListener("DOMContentLoaded",function(){let r=document.getElementById("actualites-container");if(r)try{r.innerHTML='<div class="loading">Chargement des actualités...</div>',fetch("/api/actualites").then(async e=>{var t=await e.json().catch(()=>({}));if(!e.ok)throw new Error(JSON.stringify({error:`Erreur HTTP: ${e.status} `+e.statusText,status:e.status,details:t.message||"Aucun détail supplémentaire",timestamp:(new Date).toISOString()}));if(t.success)return t;throw new Error(JSON.stringify({error:"Réponse API non réussie",status:200,details:t.message||"Aucun détail supplémentaire",timestamp:(new Date).toISOString()}))}).then(e=>{var t;return e.actualites&&0<e.actualites.length?(initNewsCarousel(e.actualites),JSON.stringify({success:!0,count:e.actualites.length,message:"Actualités chargées avec succès",timestamp:(new Date).toISOString()})):(t="undefined"!=typeof actualitesStatiques?actualitesStatiques:[])&&0<t.length?(initNewsCarousel(t),JSON.stringify({success:!0,count:t.length,source:"fallback",message:"Actualités chargées depuis la source de secours",timestamp:(new Date).toISOString()})):(t=e?.message||"Aucune actualité disponible",showNoNewsMessage(r,t),JSON.stringify({success:!1,error:"Aucune donnée disponible",details:t,timestamp:(new Date).toISOString()}))}).catch(t=>{console.error("Erreur lors du chargement des actualités:",t);let e="Impossible de charger les actualités",s={};try{var a=JSON.parse(t.message);e=a.error||e,s={status:a.status,details:a.details,timestamp:a.timestamp}}catch(e){s={originalError:t.message,timestamp:(new Date).toISOString()}}a="undefined"!=typeof actualitesStatiques?actualitesStatiques:[];return a&&0<a.length?(initNewsCarousel(a),JSON.stringify({success:!0,count:a.length,source:"fallback",message:"Actualités chargées depuis la source de secours après une erreur",error:e,...s})):(showNoNewsMessage(r,e),JSON.stringify({success:!1,error:e,...s}))}).then(t=>{if(t)try{var e=JSON.parse(t);console.log("Résultat du chargement des actualités:",e)}catch(e){console.log("Résultat du chargement des actualités (format non JSON):",t)}return t})}catch(e){console.error("Erreur lors du chargement des actualités:",e),r.innerHTML=`
            <div class="error-message" style="color: #e74c3c; text-align: center; padding: 1rem; background: #fde8e8; border-radius: 4px; margin: 1rem 0;">
                <i class="fas fa-exclamation-triangle" style="margin-right: 0.5rem;"></i>
                Une erreur est survenue lors du chargement des actualités.
                <button onclick="window.location.reload()" style="margin-top: 0.5rem; padding: 0.5rem 1rem; background: #e74c3c; color: white; border: none; border-radius: 4px; cursor: pointer;">Réessayer</button>
            </div>`}});